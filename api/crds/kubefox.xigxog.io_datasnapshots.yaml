# Copyright 2023 XigXog
#
# This Source Code Form is subject to the terms of the Mozilla Public
# License, v. 2.0. If a copy of the MPL was not distributed with this
# file, You can obtain one at https://mozilla.org/MPL/2.0/.
#
# SPDX-License-Identifier: MPL-2.0

---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.13.0
  name: datasnapshots.kubefox.xigxog.io
spec:
  group: kubefox.xigxog.io
  names:
    kind: DataSnapshot
    listKind: DataSnapshotList
    plural: datasnapshots
    shortNames:
    - data
    singular: datasnapshot
  scope: Namespaced
  versions:
  - additionalPrinterColumns:
    - jsonPath: .spec.source.name
      name: Source
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Created
      type: string
    - jsonPath: .metadata.creationTimestamp
      name: Age
      type: date
    - jsonPath: .details.title
      name: Title
      priority: 1
      type: string
    - jsonPath: .details.description
      name: Description
      priority: 1
      type: string
    name: v1alpha1
    schema:
      openAPIV3Schema:
        properties:
          apiVersion:
            description: 'APIVersion defines the versioned schema of this representation
              of an object. Servers should convert recognized schemas to the latest
              internal value, and may reject unrecognized values. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources'
            type: string
          data:
            description: Data is a copy of the source's data object. If provided at
              creation time then the source's resourceVersion and current dataChecksum
              must also be provided. If set to nil at creation time then the current
              data object, resourceVersion, and dataChecksum of the source will automatically
              be copied.
            properties:
              secrets:
                type: object
                x-kubernetes-preserve-unknown-fields: true
              vars:
                type: object
                x-kubernetes-preserve-unknown-fields: true
            type: object
          details:
            properties:
              description:
                type: string
              secrets:
                additionalProperties:
                  properties:
                    description:
                      type: string
                    title:
                      type: string
                  type: object
                type: object
              title:
                type: string
              vars:
                additionalProperties:
                  properties:
                    description:
                      type: string
                    title:
                      type: string
                  type: object
                type: object
            type: object
          kind:
            description: 'Kind is a string value representing the REST resource this
              object represents. Servers may infer this from the endpoint the client
              submits requests to. Cannot be updated. In CamelCase. More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds'
            type: string
          metadata:
            type: object
          spec:
            properties:
              source:
                description: Source resource that this snapshot is of.
                properties:
                  dataChecksum:
                    description: DataChecksum is the hash of the source's data. If
                      data is provided at creation of the snapshot then dataChecksum
                      must match the current dataChecksum of the source. If data is
                      not provided at creation time dataChecksum will be populated
                      automatically.
                    type: string
                  kind:
                    description: Kind of the resource the data is sourced from.
                    enum:
                    - VirtualEnvironment
                    type: string
                  name:
                    description: Name of the resource the data is sourced from.
                    minLength: 1
                    type: string
                  resourceVersion:
                    description: ResourceVersion of the source resource. If data is
                      provided at creation of the snapshot then resourceVersion must
                      match the current resourceVersion of the source. If data is
                      not provided at creation time resourceVersion will be populated
                      automatically.
                    type: string
                required:
                - kind
                - name
                type: object
            required:
            - source
            type: object
        type: object
    served: true
    storage: true
    subresources: {}
